<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Graphique Température - Sélection de station</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h2>Température des cours d'eau (API Hub'Eau)</h2>

    <div id="graph" style="width: 100%; height: 600px; margin-top: 30px;"></div>

    <script>

        function loadGraph() {
            const code = document.getElementById('stationSelect').value;
            const dateMin = document.getElementById('dateMin').value;
            const dateMax = document.getElementById('dateMax').value;

            fetch(`/api/temperature?code=${code}&date_min=${dateMin}&date_max=${dateMax}`)
                .then(res => res.json())
                .then(data => {
                    if (data.x.length === 0) {
                        document.getElementById("graph").innerHTML = "Aucune donnée disponible.";
                        return;
                    }

                    Plotly.newPlot('graph', [{
                        x: data.x,
                        y: data.y,
                        type: 'scatter',
                        mode: 'lines+markers',
                        name: 'Température'
                    }], {
                        title: `Évolution de la température`,
                        xaxis: { title: 'Date' },
                        yaxis: { title: 'Température (°C)' }
                    });
                });
        }
    </script>
</body>
</html>
